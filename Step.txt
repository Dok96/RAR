1) подключение с плк
    а) чтение: тэги длины, линия в работе, триггер переброса
    б) запись: тэги переброса, авария lump, авария spark

2) в плк организовать
    а) включение сирены по тегам :  авария lump, авария spark
     (сделать чисто по фронту и авто сброс аварии через кнопку и сброс  активированных тэгов )
    б) переброс катушки и скорость приёмника > 2 м/мин  будет служить триггером для создания протокола.
    Триггер протокола должен сбрасываться скриптом, то есть плк активирует его только по фронту

3) Lump / Spark
    а) подключение по rs485 (желательно), на скорости 115200
    б) создаём отдельный файл xlsx с дефектами и записываем с текущей длинной
    в) записать количество ошибок в отдельную переменную для каждого датчика

4) Формирование протокола
    а) подменить предыдущий перезаписанный файл протокола чистым шаблоном
    б) после обнаружения триггера открыть шаблон для протокола и записать данные из файла каждого датчика
    в) преобразовать в pdf
    г) сложить количество ошибок из переменных в одну общую переменную
    д) отправить на печать если ошибок > 0
    е) очистить файлы датчиков
    ё) сброс триггера протокола


